<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <title>中华经典诵读教学资源库</title>
    <link href="css/common.css" type="text/css" rel="stylesheet" />
    <link href="css/level.css" type="text/css" rel="stylesheet" />

    <!-- <script src="https://api.html5media.info/1.2.2/html5media.min.js"></script> -->

</head>

<body>
    <!--主体开始-->
    <div class="main">
        <a class="share-btn" onclick="showShare()">分 享</a>
        <!-- 独立背景开始 -->
        <img class="bj" src="./img/poetry-bj.jpg">
        <!-- 独立背景结束 -->
        <!-- 整体背景开始 -->
        <!-- <img class="bj" id="poetry"> -->
        <!-- 整体背景结束 -->
        <div class="main_box">
            <div id="menus-box"></div>
            <div class="poetry-box">
                <a class="back three-back" href="javascript:void(0)" onclick="goBack()">
                    <img src="./img/back.png" alt="返回">
                </a>
                <!-- 独立背景开始 -->
                <!-- <p class="class-abbr-title">一上 日积月累</p> -->
                <div class="poetry-com">
                    <img id="poetryCom" src="">
                </div>
                <!-- 独立背景结束 -->
                <div class="show-btns-btn">
                    <div class="media-btn">
                        <a href="javascript:void(0)" onclick="audioPlay('ds')">读诵</a>
                        <a href="javascript:void(0)" onclick="audioPlay('qy')">清吟</a>
                        <a href="javascript:void(0)" onclick="audioPlay('yy')">乐吟</a>
                        <a href="javascript:void(0)" onclick="audioPlay('ct')">传统</a>
                        <a href="javascript:void(0)" onclick="audioPlay('bz')">伴奏</a>
                        <a href="javascript:void(0)" onclick="vedioPlay()">录像</a>
                    </div>
                    <div class="media-btn-list">
                        <a href="javascript:void(0)" onclick="showMediaBtn()" class="yin1"></a>
                        <a href="javascript:void(0)" onclick="showMediaBtn()" class="song"></a>
                        <a href="javascript:void(0)" onclick="showMediaBtn()" class="lu"></a>
                        <a href="javascript:void(0)" onclick="showMediaBtn()" class="yin"></a>
                    </div>
                </div>
            </div>
        </div>
        <div class="audio-box" id="audioBox">
            <audio id="audio" class="audio" controls preload>
                <!-- <audio controls id="audio" ondrag>
                您的浏览器不支持 audio 元素。
            </audio> -->
        </div>
        <div class="login-pop" id="share">
            <h3>古诗分享 <a class="close-btn" href="javascript:void(0)" onclick="hideShare()">X</a></h3>
            <div class="login-box">
                <img id="shareImg" src="">
            </div>
        </div>
    </div>
    <script type="text/javascript" src="js/jquery-1.3.2.min.js"></script>

    <script type="text/javascript" src="js/json2.js"></script>
    <script type="text/javascript" src="js/jquery.cookie.js"></script>
    <script type="text/javascript" src="js/common.js"></script>
    <script>
        $(function() {
            var id = getUrlParam('id');
            var parentId = id.split('-')[0];
            var show = $.cookie('show') ? $.cookie('show') : '';
            var btnList = getIntention(parentId, id).intentionBtn;
            var leftHtml = '<div class="menus left-btns">';
            var rightHtml = '<div class="menus right-btns">';
            console.log(btnList)
            for (var i = 0; i < btnList.length; i++) {
                if (btnList[i].position == 'left') {
                    var btns = btnList[i].childen;
                    var btnListMarginTop = '';
                    var rightBtnMarginTop = '';
                    var leftBtnMarginTop = '';
                    var isBlock = '';
                    if (btns.length == 1) {
                        rightBtnMarginTop = 'style="margin-top:35px;"';
                        btnListMarginTop = 'style="margin-top:0;"';
                        leftBtnMarginTop = 'style="margin-top:0;"';
                    } else if (btns.length == 2) {
                        rightBtnMarginTop = 'style="margin-top:18px;"';
                        btnListMarginTop = 'style="margin-top:0;"';
                        leftBtnMarginTop = 'style="margin-top:0;"';
                    } else if (btns.length == 3) {
                        rightBtnMarginTop = '';
                        btnListMarginTop = 'style="margin-top:0;"';
                    } else if (btns.length == 4) {
                        rightBtnMarginTop = '';
                        btnListMarginTop = 'style="margin-top:0;"';
                    }
                    leftHtml += '<div class="btn-list ' + btnList[i].className + '" ' + btnListMarginTop + '><a class="left-btn" '+leftBtnMarginTop +'>' + btnList[i].text + '</a>';
                    if (show && show.indexOf(btnList[i].pid) != -1) {
                        isBlock = '<div class="right-btn" id="' + btnList[i].pid + '" ' + rightBtnMarginTop + ' style="display:block">'
                    } else {
                        isBlock = '<div class="right-btn" id="' + btnList[i].pid + '" ' + rightBtnMarginTop + '>'
                    }
                    leftHtml += isBlock;

                    for (var j = 0; j < btns.length; j++) {
                        leftHtml += '<a href="javascript:void(0)" onclick="toNext(' + ' \'' + JSON.stringify(btns[j]).replace(/"/g, '&quot;') + ' \'' + ')">' + btns[j].text + '</a>'
                    }
                    leftHtml += '</div></div>'
                }
                if (btnList[i].position == 'right') {
                    var btns = btnList[i].childen;
                    var btnListMarginTop = '';
                    var rightBtnMarginTop = '';
                    var leftBtnMarginTop = '';
                    var isBlock = '';
                    if (btns.length == 1) {
                        rightBtnMarginTop = 'style="margin-top:35px;"';
                        btnListMarginTop = 'style="margin-top:0;"';
                        leftBtnMarginTop = 'style="margin-top:0;"';
                    } else if (btns.length == 2) {
                        rightBtnMarginTop = 'style="margin-top:18px;"';
                        btnListMarginTop = 'style="margin-top:0;"';
                        leftBtnMarginTop = 'style="margin-top:0;"';
                    } else if (btns.length == 3) {
                        rightBtnMarginTop = '';
                        btnListMarginTop = 'style="margin-top:0;"';
                    } else if (btns.length == 4) {
                        rightBtnMarginTop = '';
                        btnListMarginTop = 'style="margin-top:0;"';
                    }
                    rightHtml += '<div class="btn-list ' + btnList[i].className + '" ' + btnListMarginTop + '><a class="left-btn" '+leftBtnMarginTop +'>' + btnList[i].text + '</a>';
                    if (show && show.indexOf(btnList[i].pid) != -1) {
                        isBlock = '<div class="right-btn" id="' + btnList[i].pid + '" ' + rightBtnMarginTop + ' style="display:block">';
                    } else {
                        isBlock += '<div class="right-btn" id="' + btnList[i].pid + '" ' + rightBtnMarginTop + '>';
                    }
                    rightHtml += isBlock;
                    for (var j = 0; j < btns.length; j++) {
                        rightHtml += '<a href="javascript:void(0)" onclick="toNext(' + ' \'' + JSON.stringify(btns[j]).replace(/"/g, '&quot;') + '\'' + ')">' + btns[j].text + '</a>'
                    }
                    rightHtml += '</div></div>'
                }
            }
            leftHtml += '</div>';
            rightHtml += '</div>';
            $('#menus-box').html(leftHtml + rightHtml);
            $('.btn-list > .left-btn').click(function() {
                var nowId = $(this).siblings('.right-btn').attr('id');
                if (show && show.indexOf(nowId) != -1) {
                    show = show.replace(nowId);
                    $.cookie('show', show);
                }
                $(this).siblings('.right-btn').toggle();
            })

            $('#poetry').attr('src', './img/poetry/' + id + '.jpg');
        })

        function showShare() {
            console.log($('#share'))
            $('#share').fadeIn();
            $('#shareImg').attr('src', '')
        }

        function hideShare() {
            $('#share').fadeOut();
        }

        function showMediaBtn() {
            $('.media-btn').toggle();
        }

        function toNext(url) {
            var obj = JSON.parse(url);
            var parentId = obj.parentid;
            var show = $.cookie('show') ? $.cookie('show') : '';
            if (show.indexOf(parentId) == -1) {
                show += parentId
            }
            $.cookie('show', show);
            window.location.href = obj.link

        }
    </script>
</body>

</html>
